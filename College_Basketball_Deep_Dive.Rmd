---
title: "STAT 3355 Final Project"
author: "Abhinav Yerramreddy"
date: "2024-04-11"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Adjusted Defensive Effiency

```{r}
# Load necessary libraries
library(dplyr)
library(RColorBrewer)

# Load the dataset
cbb <- read.csv("archive (1)/cbb.csv")

# Define success metric (e.g., reaching Final Four)
success_metric <- "Final Four"

# Data Analysis
# Compare defensive statistics between successful and unsuccessful teams
defensive_stats <- c("ADJDE", "efgd%", "2pd%", "3pd%", "ftrd", "drb")

# Compare defensive efficiency 

# Create Bins for Adjusted Defensive Efficiency
library(ggplot2)
cbb_new <- cbb %>%
  mutate(adjde_bins = cut(ADJDE, breaks = c(0, 84.9, 89.9, 94.9,
                                             99.9, 104.9,
                                             109.9, 114.9, 125))) %>%
  filter(POSTSEASON != "N/A")

cbb_new$POSTSEASON <- factor(cbb_new$POSTSEASON, levels = c("R68", "R64", "R32", "S16", "E8", "F4", "2ND", "Champions"))

ggplot(data = subset(cbb_new, !is.na(POSTSEASON))) +
  geom_bar(mapping = aes(x = POSTSEASON, fill = adjde_bins)) +
scale_fill_brewer(palette = "Blues", "gADJDE Legend")

#anova_result <- aov(ADJDE ~ adjde_bins, data = cbb_new)
#summary(anova_result)

correlation_result <- cor.test(cbb_new$ADJDE, as.numeric(cbb_new$POSTSEASON), method = "spearman")
print(correlation_result)


```

# Effective Opponent Field Goal Percentage

```{r}
# Load necessary libraries
library(dplyr)
library(RColorBrewer)

# Load the dataset
cbb <- read.csv("archive (1)/cbb.csv")

# Define success metric (e.g., reaching Final Four)
success_metric <- "Final Four"

# Data Analysis
# Compare defensive statistics between successful and unsuccessful teams
defensive_stats <- c("ADJDE", "efgd%", "2pd%", "3pd%", "ftrd", "drb")

# Create Bins for Effective Opponent Field Goal Percentage
cbb_new <- cbb %>%
  mutate(efgd_bins = cut(EFG_D, breaks = c(0, 39.9, 44.9,
                                            49.9,
                                             54.9, 59.9, 100))) %>%
  filter(POSTSEASON != "N/A")

cbb_new$POSTSEASON <- factor(cbb_new$POSTSEASON, levels = c("R68", "R64", "R32", "S16", "E8", "F4", "2ND", "Champions"))

# Plot Stacked Bar Plot for Effective Opponent Field Goal Percentage
ggplot(data = subset(cbb_new, !is.na(POSTSEASON))) +
  geom_bar(mapping = aes(x = POSTSEASON, fill = efgd_bins)) +
  scale_fill_brewer(palette = "Greens","EFG% Legend")

correlation_result <- cor.test(cbb_new$EFG_D, as.numeric(cbb_new$POSTSEASON), method = "spearman")
print(correlation_result)

```

# Defensive Rebounds

```{r}
# Load necessary libraries
library(dplyr)
library(RColorBrewer)

# Load the dataset
cbb <- read.csv("archive (1)/cbb.csv")

# Define success metric (e.g., reaching Final Four)
success_metric <- "Final Four"

# Data Analysis
# Compare defensive statistics between successful and unsuccessful teams
defensive_stats <- c("ADJDE", "efgd%", "2pd%", "3pd%", "ftrd", "drb")

# Create Bins for Defensive Rebounds
cbb_new <- cbb %>%
  mutate(drb_bins = cut(DRB, breaks = c(0, 14.9, 19.9, 24.9, 29.9, 34.9, 39.9, 44.9))) %>%
  filter(POSTSEASON != "N/A")

cbb_new$POSTSEASON <- factor(cbb_new$POSTSEASON, levels = c("R68", "R64", "R32", "S16", "E8", "F4", "2ND", "Champions"))

# Plot Stacked Bar Plot for Defensive Rebounds
ggplot(data = subset(cbb_new, !is.na(POSTSEASON))) +
  geom_bar(mapping = aes(x = POSTSEASON, fill = drb_bins)) +
  scale_fill_brewer(palette = "Oranges", "DRB Legend")

correlation_result <- cor.test(cbb_new$DRB, as.numeric(cbb_new$POSTSEASON), method = "spearman")
print(correlation_result)
```